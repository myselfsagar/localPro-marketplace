<%- include('../../partials/header') %> <%- include('../../partials/_messages')
%>

<main class="container">
  <h1>Manage Your Business Profile</h1>
  <p>Keep your details up to date so customers can find you.</p>

  <form action="/provider/profile" method="POST" enctype="multipart/form-data">
    <div>
      <label for="profileImage">Profile Picture</label>
      <% if (profile && profile.profileImageUrl) { %>
      <img
        src="<%= profile.profileImageUrl %>"
        alt="Current Profile Picture"
        style="
          max-width: 120px;
          height: 120px;
          object-fit: cover;
          border-radius: 50%;
          display: block;
          margin-bottom: 10px;
        "
      />
      <p>Change Picture:</p>
      <% } %>
      <input
        type="file"
        id="profileImage"
        name="profileImage"
        accept="image/png, image/jpeg, image/gif"
      />
    </div>

    <hr />

    <div>
      <label for="businessName">Business Name</label>
      <input
        type="text"
        id="businessName"
        name="businessName"
        value="<%= profile ? profile.businessName : '' %>"
        required
      />
    </div>
    <div>
      <label for="phoneNumber">Phone Number</label>
      <input
        type="tel"
        id="phoneNumber"
        name="phoneNumber"
        value="<%= profile ? profile.phoneNumber : '' %>"
      />
    </div>
    <div>
      <label for="location">Location (e.g., Bengaluru, Karnataka)</label>
      <input
        type="text"
        id="location"
        name="location"
        value="<%= profile ? profile.location : '' %>"
      />
    </div>
    <div>
      <label for="bio">About Your Business</label>
      <textarea id="bio" name="bio" rows="4">
<%= profile ? profile.bio : '' %></textarea
      >
    </div>

    <button type="submit">Save Profile</button>
  </form>

  <hr />

  <h2>Your Services</h2>
  <% if (services.length > 0) { %>
  <ul style="list-style-type: none; padding-left: 0">
    <% services.forEach(service => { %>
    <li
      style="
        margin-bottom: 1.5rem;
        border-bottom: 1px solid #eee;
        padding-bottom: 1.5rem;
      "
    >
      <img
        src="<%= service.imageUrl || '/images/default-service.png' %>"
        alt="<%= service.name %>"
        style="
          width: 120px;
          height: 120px;
          object-fit: cover;
          border-radius: 5px;
          float: left;
          margin-right: 15px;
        "
      />

      <strong><%= service.name %></strong> - $<%= service.price %>
      <p><%= service.description %></p>
      <a href="/provider/services/<%= service.id %>/edit" class="btn">Edit</a>

      <form
        action="/provider/services/<%= service.id %>/delete"
        method="POST"
        style="display: inline; margin-left: 10px"
      >
        <button
          type="submit"
          class="btn-cancel"
          onclick="return confirm('Are you sure you want to delete this service?');"
        >
          Delete
        </button>
      </form>

      <div style="clear: both"></div>
    </li>
    <% }) %>
  </ul>
  <% } else { %>
  <p>You haven't added any services yet.</p>
  <% } %>

  <a href="/provider/services/new" class="btn">Add New Service</a>
</main>

<%- include('../../partials/footer') %>
